.. 
   Input file: fe/ips/udma/udma_mram/README.md

Register map
^^^^^^^^^^^^


Overview
""""""""


Refer to :ref:`GAP9 address map<REF_MEMORY_MAP_DETAIL>` for the base address to be used.

.. table:: 
    :align: center
    :widths: 40 12 12 90

    +----------------------------------------+------+-----+---------------------------------+
    |                  Name                  |Offset|Width|           Description           |
    +========================================+======+=====+=================================+
    |:ref:`RX_DEST<udma_mram__RX_DEST>`      |0x0   |   32|Stream ID for the uDMA RX channel|
    +----------------------------------------+------+-----+---------------------------------+
    |:ref:`TX_DEST<udma_mram__TX_DEST>`      |0x4   |   32|Stream ID for the uDMA TX channel|
    +----------------------------------------+------+-----+---------------------------------+
    |:ref:`TRANS_MODE<udma_mram__TRANS_MODE>`|0x8   |   32|UDMA transaction mode            |
    +----------------------------------------+------+-----+---------------------------------+
    |:ref:`TRANS_ADDR<udma_mram__TRANS_ADDR>`|0xC   |   32|UDMA transaction address         |
    +----------------------------------------+------+-----+---------------------------------+
    |:ref:`TRANS_SIZE<udma_mram__TRANS_SIZE>`|0x10  |   32|UDMA transaction size            |
    +----------------------------------------+------+-----+---------------------------------+
    |:ref:`TRANS_CFG<udma_mram__TRANS_CFG>`  |0x14  |   32|Start of TX/RX transaction       |
    +----------------------------------------+------+-----+---------------------------------+
    |:ref:`EXT_ADDR<udma_mram__EXT_ADDR>`    |0x18  |   32|Target MRAM address              |
    +----------------------------------------+------+-----+---------------------------------+
    |:ref:`STATUS<udma_mram__STATUS>`        |0x1C  |   32|MRAM status                      |
    +----------------------------------------+------+-----+---------------------------------+
    |:ref:`MODE<udma_mram__MODE>`            |0x20  |   32|MRAM mode                        |
    +----------------------------------------+------+-----+---------------------------------+
    |:ref:`ERASE_ADDR<udma_mram__ERASE_ADDR>`|0x24  |   32|Erase address                    |
    +----------------------------------------+------+-----+---------------------------------+
    |:ref:`ERASE_SIZE<udma_mram__ERASE_SIZE>`|0x28  |   32|Erase size                       |
    +----------------------------------------+------+-----+---------------------------------+
    |:ref:`CLK_DIV<udma_mram__CLK_DIV>`      |0x2C  |   32|Clock divider                    |
    +----------------------------------------+------+-----+---------------------------------+
    |:ref:`ISR<udma_mram__ISR>`              |0x30  |   32|IRQ status register              |
    +----------------------------------------+------+-----+---------------------------------+
    |:ref:`IER<udma_mram__IER>`              |0x34  |   32|IRQ enable register              |
    +----------------------------------------+------+-----+---------------------------------+
    |:ref:`LINE_2D<udma_mram__LINE_2D>`      |0x3C  |   32|MRAM 2D line size                |
    +----------------------------------------+------+-----+---------------------------------+
    |:ref:`STRIDE_2D<udma_mram__STRIDE_2D>`  |0x40  |   32|MRAM 2D stride                   |
    +----------------------------------------+------+-----+---------------------------------+
    |:ref:`ENABLE_2D<udma_mram__ENABLE_2D>`  |0x44  |   32|2D mode enable                   |
    +----------------------------------------+------+-----+---------------------------------+
    |:ref:`TIMING_CFG<udma_mram__TIMING_CFG>`|0x48  |   32|Timing configuration             |
    +----------------------------------------+------+-----+---------------------------------+

.. _udma_mram__RX_DEST:

RX_DEST
"""""""

Stream ID for the uDMA RX channel

.. table:: 
    :align: center
    :widths: 13 12 45 24 85

    +-----+---+----+-----+-------------------------------------------------------------+
    |Bit #|R/W|Name|Reset|                         Description                         |
    +=====+===+====+=====+=============================================================+
    |7:0  |R/W|DEST|0xFF |Stream ID for the uDMA RX channel. Default is 0xFF (disabled)|
    +-----+---+----+-----+-------------------------------------------------------------+

.. _udma_mram__TX_DEST:

TX_DEST
"""""""

Stream ID for the uDMA TX channel

.. table:: 
    :align: center
    :widths: 13 12 45 24 85

    +-----+---+----+-----+-------------------------------------------------------------+
    |Bit #|R/W|Name|Reset|                         Description                         |
    +=====+===+====+=====+=============================================================+
    |7:0  |R/W|DEST|0xFF |Stream ID for the uDMA TX channel. Default is 0xFF (disabled)|
    +-----+---+----+-----+-------------------------------------------------------------+

.. _udma_mram__TRANS_MODE:

TRANS_MODE
""""""""""

UDMA transaction mode

.. table:: 
    :align: center
    :widths: 13 12 45 24 85

    +-----+---+---------------+-----+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |Bit #|R/W|     Name      |Reset|                                                                                            Description                                                                                            |
    +=====+===+===============+=====+===================================================================================================================================================================================================+
    |    0|R/W|AUTO_ENA       |0x0  |Enables AUTO transfer mode, in which the uDMA transfers are configured automatically, according to register parameters, instead of using SW configuration of uDMA: b0: disabled; b1: enabled       |
    +-----+---+---------------+-----+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |    1|R/W|XIP_EN         |0x0  |Enables XIP transfer mode, in which the uDMA transfers are configured automatically, using XIP parameters, instead of using SW configuration of uDMA: b0: disabled; b1: enabled. Requires AUTO mode|
    +-----+---+---------------+-----+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |3:2  |R  |RESERVED       |0x0  |--                                                                                                                                                                                                 |
    +-----+---+---------------+-----+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |    4|R/W|XIP_HALTED     |0x0  |In XIP mode, halt XIP refill until SW clears this bit: b0: XIP running; b1: XIP halted                                                                                                             |
    +-----+---+---------------+-----+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |    5|R/W|XIP_AUTO_HALTED|0x0  |Automatically halt XIP refill when an erase operation is ongoing: b0: disabled; b1: enabled                                                                                                        |
    +-----+---+---------------+-----+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _udma_mram__TRANS_ADDR:

TRANS_ADDR
""""""""""

UDMA transaction address

.. table:: 
    :align: center
    :widths: 13 12 45 24 85

    +-----+---+----+-----+------------------------------------------------+
    |Bit #|R/W|Name|Reset|                  Description                   |
    +=====+===+====+=====+================================================+
    |31:0 |R/W|ADDR|0x0  |UDMA transfer address when transfer mode is AUTO|
    +-----+---+----+-----+------------------------------------------------+

.. _udma_mram__TRANS_SIZE:

TRANS_SIZE
""""""""""

UDMA transaction size

.. table:: 
    :align: center
    :widths: 13 12 45 24 85

    +-----+---+----+-----+----------------------------------------+
    |Bit #|R/W|Name|Reset|              Description               |
    +=====+===+====+=====+========================================+
    |20:0 |R/W|SIZE|0x0  |Transfer size when transfer mode is AUTO|
    +-----+---+----+-----+----------------------------------------+

.. _udma_mram__TRANS_CFG:

TRANS_CFG
"""""""""

Start of TX/RX transaction

.. table:: 
    :align: center
    :widths: 13 12 45 24 85

    +-----+---+-----+-----+-----------------------------------------------------------------------------+
    |Bit #|R/W|Name |Reset|                                 Description                                 |
    +=====+===+=====+=====+=============================================================================+
    |    0|R/W|RXTX |0x0  |Transfer type: b0: TX; b1: RX                                                |
    +-----+---+-----+-----+-----------------------------------------------------------------------------+
    |    1|R/W|VALID|0x0  |Write b0 to clear transfer, write b1 to start transfer. Read always returns O|
    +-----+---+-----+-----+-----------------------------------------------------------------------------+

.. _udma_mram__EXT_ADDR:

EXT_ADDR
""""""""

Target MRAM address

.. table:: 
    :align: center
    :widths: 13 12 45 24 85

    +-----+---+----+-----+--------------------------------------------------+
    |Bit #|R/W|Name|Reset|                   Description                    |
    +=====+===+====+=====+==================================================+
    |31:0 |R/W|ADDR|0x0  |Target address in MRAM (bits 21 to 31 are ignored)|
    +-----+---+----+-----+--------------------------------------------------+

.. _udma_mram__STATUS:

STATUS
""""""

MRAM status

.. table:: 
    :align: center
    :widths: 13 12 45 24 85

    +-----+---+----------+-----+-----------------------------------------------------------------------------------------------------------------------------------------------+
    |Bit #|R/W|   Name   |Reset|                                                                  Description                                                                  |
    +=====+===+==========+=====+===============================================================================================================================================+
    |    0|R  |ERASE_BUSY|0x0  |Erase busy: reads b1 when an MRAM erase operation is ongoing                                                                                   |
    +-----+---+----------+-----+-----------------------------------------------------------------------------------------------------------------------------------------------+
    |    1|R  |TX_BUSY   |0x0  |TX busy: reads b1 when a TX transfer is ongoing                                                                                                |
    +-----+---+----------+-----+-----------------------------------------------------------------------------------------------------------------------------------------------+
    |    2|R  |RX_BUSY   |0x0  |RX busy: reads b1 when an RX transfer is ongoing                                                                                               |
    +-----+---+----------+-----+-----------------------------------------------------------------------------------------------------------------------------------------------+
    |    3|R  |RESERVED  |0x0  |--                                                                                                                                             |
    +-----+---+----------+-----+-----------------------------------------------------------------------------------------------------------------------------------------------+
    |    4|R  |UE_ERR    |0x0  |Unrecoverable error: reads b1 if any unrecoverable error is detected. Not 100% accurate for 3+ bit errors (84% detection rate for 3-bit errors)|
    +-----+---+----------+-----+-----------------------------------------------------------------------------------------------------------------------------------------------+
    |    5|R  |EC_ERR    |0x0  |ECC-corrected errors: reads b0 if no error is detected, reads b1 if a 1- or 2-bit error has been corrected                                     |
    +-----+---+----------+-----+-----------------------------------------------------------------------------------------------------------------------------------------------+

.. _udma_mram__MODE:

MODE
""""

MRAM mode

.. table:: 
    :align: center
    :widths: 13 12 45 24 85

    +-----+---+---------+-----+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |Bit #|R/W|  Name   |Reset|                                                                         Description                                                                          |
    +=====+===+=========+=====+==============================================================================================================================================================+
    |    0|R/W|ECCBYPS  |0x0  |Controls MRAM ECC bypass signal                                                                                                                               |
    +-----+---+---------+-----+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |    1|R/W|DPD      |0x0  |Controls MRAM deep power down signal                                                                                                                          |
    +-----+---+---------+-----+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |    3|R/W|TMEN     |0x0  |Controls MRAM TMEN signal                                                                                                                                     |
    +-----+---+---------+-----+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |    4|R/W|NVR      |0x0  |Controls MRAM NVR  signal                                                                                                                                     |
    +-----+---+---------+-----+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |    5|R/W|RSTb     |0x0  |Controls MRAM RSTb signal                                                                                                                                     |
    +-----+---+---------+-----+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |    6|R/W|RETb     |0x0  |Controls MRAM RETb signal                                                                                                                                     |
    +-----+---+---------+-----+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |    7|R/W|PORb     |0x0  |Controls MRAM PORb signal                                                                                                                                     |
    +-----+---+---------+-----+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |15:8 |R/W|OPERATION|0x0  |Configure MRAM operation: h00: power up; h01: configure trimming; h02: program; h04: chip erase; h08: sector erase; h10 word erase; h20: power down; h40: read|
    +-----+---+---------+-----+--------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _udma_mram__ERASE_ADDR:

ERASE_ADDR
""""""""""

Erase address

.. table:: 
    :align: center
    :widths: 13 12 45 24 85

    +-----+---+----+-----+---------------------------------------+
    |Bit #|R/W|Name|Reset|              Description              |
    +=====+===+====+=====+=======================================+
    |20:0 |R/W|ADDR|0x0  |Erase address (bits 0 to 3 are ignored)|
    +-----+---+----+-----+---------------------------------------+

.. _udma_mram__ERASE_SIZE:

ERASE_SIZE
""""""""""

Erase size

.. table:: 
    :align: center
    :widths: 13 12 45 24 85

    +-----+---+----+-----+-----------+
    |Bit #|R/W|Name|Reset|Description|
    +=====+===+====+=====+===========+
    |6:0  |R/W|SIZE|0x0  |Erase Size |
    +-----+---+----+-----+-----------+

.. _udma_mram__CLK_DIV:

CLK_DIV
"""""""

Clock divider

.. table:: 
    :align: center
    :widths: 13 12 45 24 85

    +-----+---+------+-----+--------------------------------------------------------------------------------------------------------------------------------+
    |Bit #|R/W| Name |Reset|                                                          Description                                                           |
    +=====+===+======+=====+================================================================================================================================+
    |7:0  |R/W|DATA  |0x0  |Clock divider ratio (0-255): PERIPH clock frequency is divided by DATA                                                          |
    +-----+---+------+-----+--------------------------------------------------------------------------------------------------------------------------------+
    |8    |R/W|VALID |0x0  |Set to b1 to have divider ratio taken into account; automatically reset to b0 by the system once the ratio is taken into account|
    +-----+---+------+-----+--------------------------------------------------------------------------------------------------------------------------------+
    |9    |R/W|ENABLE|0x0  |Enable MRAM clock: b0: clock gated; b1: clock enabled                                                                           |
    +-----+---+------+-----+--------------------------------------------------------------------------------------------------------------------------------+

.. _udma_mram__ISR:

ISR
"""

IRQ status register

.. table:: 
    :align: center
    :widths: 13 12 45 24 85

    +-----+---+----------------+-----+----------------------------------------+
    |Bit #|R/W|      Name      |Reset|              Description               |
    +=====+===+================+=====+========================================+
    |    0|R  |ERASE_DONE      |0x0  |End-of-erase IRQ status                 |
    +-----+---+----------------+-----+----------------------------------------+
    |    1|R  |PROGRAM_DONE    |0x0  |End-of-program IRQ status               |
    +-----+---+----------------+-----+----------------------------------------+
    |    2|R  |TRIM_CONFIG_DONE|0x0  |End-of-trimming-configuration IRQ status|
    +-----+---+----------------+-----+----------------------------------------+
    |    3|R  |RX_DONE         |0x0  |End-of-read IRQ status                  |
    +-----+---+----------------+-----+----------------------------------------+

.. _udma_mram__IER:

IER
"""

IRQ enable register

.. table:: 
    :align: center
    :widths: 13 12 45 24 85

    +-----+---+------------------+-----+--------------------------------------------+
    |Bit #|R/W|       Name       |Reset|                Description                 |
    +=====+===+==================+=====+============================================+
    |    0|R/W|ERASE_EN          |0x0  |Enable end-of-erase IRQ                     |
    +-----+---+------------------+-----+--------------------------------------------+
    |    1|R/W|PROGRAM_EN        |0x0  |Enable end-of-program IRQ                   |
    +-----+---+------------------+-----+--------------------------------------------+
    |    2|R/W|TRIM_CONFIG_EN    |0x0  |Enable end-of-trimming-configuration IRQ    |
    +-----+---+------------------+-----+--------------------------------------------+
    |    3|R/W|RX_DONE_EN        |0x0  |Enable end-of-read IRQ                      |
    +-----+---+------------------+-----+--------------------------------------------+
    |    4|R/W|XIP_ERASE_EN      |0x0  |Enable end-of-XIP erase IRQ                 |
    +-----+---+------------------+-----+--------------------------------------------+
    |    5|R/W|XIP_PROGRAM_EN    |0x0  |Enable end-of-XIP program IRQ               |
    +-----+---+------------------+-----+--------------------------------------------+
    |    6|R/W|XIP_TRIM_CONFIG_EN|0x0  |Enable end-of-XIP trimming-configuration IRQ|
    +-----+---+------------------+-----+--------------------------------------------+
    |    7|R/W|RX_XIP_DONE_EN    |0x0  |Enable end-of-XIP read IRQ                  |
    +-----+---+------------------+-----+--------------------------------------------+

.. _udma_mram__LINE_2D:

LINE_2D
"""""""

MRAM 2D line size

.. table:: 
    :align: center
    :widths: 13 12 45 24 85

    +-----+---+----+-----+-----------------------------------------------------------------------------------------------------------------------+
    |Bit #|R/W|Name|Reset|                                                      Description                                                      |
    +=====+===+====+=====+=======================================================================================================================+
    |31:0 |R/W|LINE|0x0  |Length of MRAM 2D line when in 2D mode. For example, ADDR = START_ADDR + i * BURST_STRIDE. Normally, LINE >= BURST_SIZE|
    +-----+---+----+-----+-----------------------------------------------------------------------------------------------------------------------+

.. _udma_mram__STRIDE_2D:

STRIDE_2D
"""""""""

MRAM 2D stride

.. table:: 
    :align: center
    :widths: 13 12 45 24 85

    +-----+---+------+-----+---------------------------------------------------------------------------------------------------------------------------+
    |Bit #|R/W| Name |Reset|                                                        Description                                                        |
    +=====+===+======+=====+===========================================================================================================================+
    |31:0 |R/W|STRIDE|0x0  |Length of MRAM 2D stride when in 2D mode. For example, ADDR = START_ADDR + i * BURST_STRIDE. Normally, STRIDE >= BURST_SIZE|
    +-----+---+------+-----+---------------------------------------------------------------------------------------------------------------------------+

.. _udma_mram__ENABLE_2D:

ENABLE_2D
"""""""""

2D mode enable

.. table:: 
    :align: center
    :widths: 13 12 45 24 85

    +-----+---+------+-----+--------------------------------------------------------------+
    |Bit #|R/W| Name |Reset|                         Description                          |
    +=====+===+======+=====+==============================================================+
    |    0|R/W|ENABLE|0x0  |MRAM 2D mode enable: b0: 2D mode disabled; b1: 2D mode enabled|
    +-----+---+------+-----+--------------------------------------------------------------+

.. _udma_mram__TIMING_CFG:

TIMING_CFG
""""""""""

Timing configuration

.. table:: 
    :align: center
    :widths: 13 12 45 24 85

    +-----+---+---------------+-----+------------------------------------------+
    |Bit #|R/W|     Name      |Reset|               Description                |
    +=====+===+===============+=====+==========================================+
    |2:0  |R/W|STROBE_TIME_CNT|0x2  |Strobe timing counter                     |
    +-----+---+---------------+-----+------------------------------------------+
    |5:3  |R/W|GO_SUP_TIME_CNT|0x4  |Power supply timing counter               |
    +-----+---+---------------+-----+------------------------------------------+
    |8:6  |R/W|MEN_TIME_CNT   |0x4  |MRAM EN timing counter                    |
    +-----+---+---------------+-----+------------------------------------------+
    |15:9 |R/W|RW_TIME_CNT    |0x78 |Latency from write to read timing counter |
    +-----+---+---------------+-----+------------------------------------------+
    |18:16|R/W|ADS_TIME_CNT   |0x4  |Address setup timing counter              |
    +-----+---+---------------+-----+------------------------------------------+
    |28:19|R/W|PGS_TIME_CNT   |0x320|Program setup timing counter              |
    +-----+---+---------------+-----+------------------------------------------+
    |31:29|R/W|PROG_TIME_CNT  |0x8  |Program minimum pulse width timing counter|
    +-----+---+---------------+-----+------------------------------------------+
