.. 
   Input file: fe/ips/udma/udma_uart/docs/doc.md

Register map
^^^^^^^^^^^^


Overview
""""""""


Refer to :ref:`GAP9 address map<REF_MEMORY_MAP_DETAIL>` for the base address to be used.

.. table:: 
    :align: center
    :widths: 40 12 12 90

    +------------------------------------------+------+-----+----------------------------------+
    |                   Name                   |Offset|Width|           Description            |
    +==========================================+======+=====+==================================+
    |:ref:`RX_DEST<udma_uart__RX_DEST>`        |0x0   |   32|Stream ID for the uDMA RX channel |
    +------------------------------------------+------+-----+----------------------------------+
    |:ref:`TX_DEST<udma_uart__TX_DEST>`        |0x4   |   32|Stream ID for the uDMA TX channel |
    +------------------------------------------+------+-----+----------------------------------+
    |:ref:`MISC<udma_uart__MISC>`              |0x10  |   32|Send events                       |
    +------------------------------------------+------+-----+----------------------------------+
    |:ref:`STATUS<udma_uart__STATUS>`          |0x20  |   32|Status register                   |
    +------------------------------------------+------+-----+----------------------------------+
    |:ref:`SETUP<udma_uart__SETUP>`            |0x24  |   32|Configuration register            |
    +------------------------------------------+------+-----+----------------------------------+
    |:ref:`ERROR<udma_uart__ERROR>`            |0x28  |   32|Error register, cleared on reading|
    +------------------------------------------+------+-----+----------------------------------+
    |:ref:`IRQ_EN<udma_uart__IRQ_EN>`          |0x2C  |   32|Enable/disable events             |
    +------------------------------------------+------+-----+----------------------------------+
    |:ref:`SETUP_2<udma_uart__SETUP_2>`        |0x38  |   32|Configuration register 2          |
    +------------------------------------------+------+-----+----------------------------------+
    |:ref:`REF_CLK_MUX<udma_uart__REF_CLK_MUX>`|0x3C  |   32|Clock selection for the UART      |
    +------------------------------------------+------+-----+----------------------------------+

.. _udma_uart__RX_DEST:

RX_DEST
"""""""

Stream ID for the uDMA RX channel

.. table:: 
    :align: center
    :widths: 13 12 45 24 85

    +-----+---+-------+-----+---------------------------------------------------------------------+
    |Bit #|R/W| Name  |Reset|                             Description                             |
    +=====+===+=======+=====+=====================================================================+
    |7:0  |RW |RX_DEST|0xFF |Stream ID for the RX uDMA channel. Default is 0xFF (channel disabled)|
    +-----+---+-------+-----+---------------------------------------------------------------------+

.. _udma_uart__TX_DEST:

TX_DEST
"""""""

Stream ID for the uDMA TX channel

.. table:: 
    :align: center
    :widths: 13 12 45 24 85

    +-----+---+-------+-----+---------------------------------------------------------------------+
    |Bit #|R/W| Name  |Reset|                             Description                             |
    +=====+===+=======+=====+=====================================================================+
    |7:0  |RW |TX_DEST|0xFF |Stream ID for the TX uDMA channel. Default is 0xFF (channel disabled)|
    +-----+---+-------+-----+---------------------------------------------------------------------+

.. _udma_uart__MISC:

MISC
""""

Send events

.. table:: 
    :align: center
    :widths: 13 12 45 24 85

    +-----+---+---------------------+-----+---------------------------+
    |Bit #|R/W|        Name         |Reset|        Description        |
    +=====+===+=====================+=====+===========================+
    |    0|W  |TX_FIFO_CLEAR_EVENT_O|    0|Send event to clear TX FIFO|
    +-----+---+---------------------+-----+---------------------------+
    |    1|W  |RX_FIFO_CLEAR_EVENT_O|    0|Send event to clear RX FIFO|
    +-----+---+---------------------+-----+---------------------------+
    |    2|W  |TX_FSM_RESET_EVENT_O |    0|Send event to reset TX FSM |
    +-----+---+---------------------+-----+---------------------------+
    |    3|W  |RX_FSM_RESET_EVENT_O |    0|Send event to reset RX FSM |
    +-----+---+---------------------+-----+---------------------------+

.. _udma_uart__STATUS:

STATUS
""""""

Status register

.. table:: 
    :align: center
    :widths: 13 12 45 24 85

    +-----+---+-------+-----+------------------------------+
    |Bit #|R/W| Name  |Reset|         Description          |
    +=====+===+=======+=====+==============================+
    |    0|R  |TX_BUSY|    0|Transmitter is sending a frame|
    +-----+---+-------+-----+------------------------------+
    |    1|R  |RX_BUSY|    0|Receiver is receiving a frame |
    +-----+---+-------+-----+------------------------------+

.. _udma_uart__SETUP:

SETUP
"""""

Configuration register

.. table:: 
    :align: center
    :widths: 13 12 45 24 85

    +-----+---+----------+-----+-----------------------------------------------------------------------------------------------------------------+
    |Bit #|R/W|   Name   |Reset|                                                   Description                                                   |
    +=====+===+==========+=====+=================================================================================================================+
    |    0|RW |PARITY_ENA|    0|Enable parity bit for TX and RX blocks                                                                           |
    +-----+---+----------+-----+-----------------------------------------------------------------------------------------------------------------+
    |2:1  |RW |BIT_LENGTH|    0|RX/TX word width (see encoding below)                                                                            |
    +-----+---+----------+-----+-----------------------------------------------------------------------------------------------------------------+
    |    3|RW |STOP_BITS |    0|Stop bits count (see encoding below)                                                                             |
    +-----+---+----------+-----+-----------------------------------------------------------------------------------------------------------------+
    |    8|RW |TX_ENA    |    0|Enable transmitter                                                                                               |
    +-----+---+----------+-----+-----------------------------------------------------------------------------------------------------------------+
    |    9|RW |RX_ENA    |    0|Enable receiver                                                                                                  |
    +-----+---+----------+-----+-----------------------------------------------------------------------------------------------------------------+
    |   10|RW |CTS_EN    |    0|Flow control: enable Clear To Send input pin. Transmitter will send next word if UART CTS input is 0.            |
    +-----+---+----------+-----+-----------------------------------------------------------------------------------------------------------------+
    |   11|RW |RTS_EN    |    0|Flow control: enable Ready To Send output pin. UART RTS output is set to 0 if the receiver can receive next word.|
    +-----+---+----------+-----+-----------------------------------------------------------------------------------------------------------------+
    |   12|RW |TX_CLK_EN |    0|Enable synchronous master mode                                                                                   |
    +-----+---+----------+-----+-----------------------------------------------------------------------------------------------------------------+
    |   13|RW |TX_CLK_POL|    0|Configure TX clock polarity (see encoding below)                                                                 |
    +-----+---+----------+-----+-----------------------------------------------------------------------------------------------------------------+
    |   14|RW |TX_CLK_PHA|    0|Configure TX clock phase (see encoding below)                                                                    |
    +-----+---+----------+-----+-----------------------------------------------------------------------------------------------------------------+
    |31:16|RW |CLKDIV    |    0|Baudrate divider applied to selected internal clock. Baudrate = Clk_freq / (CLKDIV + 1)                          |
    +-----+---+----------+-----+-----------------------------------------------------------------------------------------------------------------+

.. _udma_uart__ERROR:

ERROR
"""""

Error register, cleared on reading

.. table:: 
    :align: center
    :widths: 13 12 45 24 85

    +-----+---+------------+-----+--------------------+
    |Bit #|R/W|    Name    |Reset|    Description     |
    +=====+===+============+=====+====================+
    |    0|R  |ERR_OVERFLOW|    0|RX overflow flag    |
    +-----+---+------------+-----+--------------------+
    |    1|R  |ERR_PARITY  |    0|RX parity error flag|
    +-----+---+------------+-----+--------------------+

.. _udma_uart__IRQ_EN:

IRQ_EN
""""""

Enable/disable events

.. table:: 
    :align: center
    :widths: 13 12 45 24 85

    +-----+---+-------+-----+-----------------------------------------------------------------+
    |Bit #|R/W| Name  |Reset|                           Description                           |
    +=====+===+=======+=====+=================================================================+
    |    0|R/W|RX_IRQ |    0|Emit event if RX received a word                                 |
    +-----+---+-------+-----+-----------------------------------------------------------------+
    |    1|R/W|ERR_IRQ|    0|Emit event on an error (see ERROR register)                      |
    +-----+---+-------+-----+-----------------------------------------------------------------+
    |    2|R/W|TX_IRQ |    0|Emit event after a byte is sent, after stop symbol is transmitted|
    +-----+---+-------+-----+-----------------------------------------------------------------+

.. _udma_uart__SETUP_2:

SETUP_2
"""""""

Configuration register 2

.. table:: 
    :align: center
    :widths: 13 12 45 24 85

    +-----+---+--------------+-----+----------------------------------------------------------------------------------------------+
    |Bit #|R/W|     Name     |Reset|                                         Description                                          |
    +=====+===+==============+=====+==============================================================================================+
    |3:0  |R/W|RTS_HIGH_LIMIT|    4|Deassert UART RTS when number of data in the FIFO :math:`\geq` RTS_HIGH_LIMIT. FIFO size is 8.|
    +-----+---+--------------+-----+----------------------------------------------------------------------------------------------+

.. _udma_uart__REF_CLK_MUX:

REF_CLK_MUX
"""""""""""

Clock selection for the UART

.. table:: 
    :align: center
    :widths: 13 12 45 24 85

    +-----+---+----------------+-----+------------------------------------------------------------------+
    |Bit #|R/W|      Name      |Reset|                           Description                            |
    +=====+===+================+=====+==================================================================+
    |    0|R/W|SEL_REF_FAST_CLK|    0|Set to 1 to use REF FAST clock as IP clock instead of PERIPH clock|
    +-----+---+----------------+-----+------------------------------------------------------------------+
